<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LISD Help Document Finder</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    #results a { display: block; margin-bottom: 10px; }
    #results span { font-size: 0.9em; color: gray; }
  </style>
</head>
<body>

<div style="display: flex; align-items: center;">
  <img src="dlogo.png" alt="DeFo logo" style="height: 64px; margin-right: 10px;">
  <h1>LISD Help Document Finder</h1>
</div>

<a href="https://www.deforest.k12.wi.us/district/learning-information-systems.cfm" target="_blank">LISD Home Page</a> ｜ 
<a href="https://lisd.deforestschools.org/" target="_blank">Tech Request System</a> ｜ 
Help Desk: <strong>608-842-6535</strong>

<h3>What do you need help with?</h3>
<input type="text" id="searchBox" placeholder="Start typing..." autocomplete="off" style="width: 500px; padding: 8px;">
<p>
<div id="results"></div>

<!-- Include Fuse.js locally -->
<script src="fuse.min.js"></script>

<script>
  let helpData = [];
  let fuse = null;

  // Load the JSON data
  fetch('help_data.json')
    .then(response => response.json())
    .then(data => {
      helpData = data;

      // Initialize Fuse with config
      const options = {
        keys: ['title', 'keywords'],
        threshold: 0.4,        // Lower = stricter match
        ignoreLocation: true,  // Don't penalize based on word position
        includeScore: true     // Optional, but may help with debugging
      };

      fuse = new Fuse(helpData, options);
    });

  document.getElementById('searchBox').addEventListener('input', function () {
    const query = this.value.trim();

    // Exit if no search or data not ready
    if (!query || !fuse) {
      document.getElementById('results').innerHTML = '';
      return;
    }

    // Run fuzzy search
    const results = fuse.search(query).slice(0, 10); // Limit to 10 results

    // Generate HTML
    const resultHtml = results.map(r =>
      `<div><a href="${r.item.url}" target="_blank">${r.item.title}<br><span>${r.item.keywords.join(', ')}</span></a></div>`
    ).join('');

    document.getElementById('results').innerHTML = resultHtml || '<p>No results found.</p>';
  });
</script>

</body>
</html>
